{
  "application_name": "Reclaim - Digital Wellness Recovery App",
  "application_type": "React Native Mobile Application",
  "target_platform": "Android (testable via Expo Go)",
  "description": "A compassionate mobile application designed to support individuals on their digital wellness and recovery journey. The app provides evidence-based tools, progress tracking, and supportive features to help users reclaim their lives from digital addiction and unhealthy online habits.",

  "tech_stack": {
    "framework": "React Native with Expo",
    "language": "TypeScript",
    "state_management": "React Hooks and Context API",
    "navigation": "React Navigation",
    "database": "MongoDB with Mongoose ODM",
    "styling": "React Native Paper or Native Base for UI components",
    "additional_libraries": [
      "React Native AsyncStorage for local storage",
      "React Native Reanimated for animations",
      "Expo Notifications for reminders",
      "React Native SVG for icons and graphics",
      "Axios for API calls"
    ]
  },

  "design_system": {
    "color_palette": {
      "primary": {
        "main": "#3FB78D",
        "light": "#66D4AB",
        "dark": "#2C8F6C",
        "description": "Healing green - represents growth and renewal"
      },
      "secondary": {
        "blue": "#5BA3D0",
        "blue_light": "#8BC4E0",
        "description": "Calming blue accents"
      },
      "background": {
        "main": "#F7FAF9",
        "card": "#FFFFFF",
        "muted": "#EEF3F1"
      },
      "emotional_states": {
        "success": "#3EB489",
        "warning": "#F5C842",
        "destructive": "#E85D5D",
        "compassion": "#E89D6B"
      },
      "text": {
        "primary": "#1A3A31",
        "secondary": "#6B8F83",
        "muted": "#98B5AA"
      }
    },
    "typography": {
      "font_family": "System fonts (San Francisco for iOS, Roboto for Android)",
      "heading_sizes": {
        "h1": 32,
        "h2": 24,
        "h3": 20,
        "h4": 18
      },
      "body_sizes": {
        "large": 16,
        "regular": 14,
        "small": 12
      }
    },
    "spacing": {
      "base_unit": 8,
      "description": "Use 8px grid system (8, 16, 24, 32, 40, 48, etc.)"
    },
    "shadows_and_elevation": {
      "soft": "elevation: 2",
      "medium": "elevation: 4",
      "strong": "elevation: 8"
    },
    "animations": {
      "duration": {
        "fast": 200,
        "medium": 300,
        "slow": 500
      },
      "easing": "ease-in-out"
    }
  },

  "app_flow": {
    "initial_launch": "Landing Page",
    "after_onboarding": "Dashboard",
    "states": [
      "landing",
      "onboarding",
      "dashboard",
      "urge-toolkit",
      "relapse-recovery"
    ]
  },

  "features_and_screens": {
    "1_landing_page": {
      "name": "Landing Page",
      "route": "/landing",
      "description": "First screen users see when opening the app for the first time",
      "components": [
        {
          "type": "Hero Section",
          "elements": [
            {
              "element": "Logo/Icon",
              "icon": "TreePine",
              "description": "Animated tree icon representing growth"
            },
            {
              "element": "Headline",
              "text": "Reclaim Your Life",
              "style": "Large, bold gradient text (healing green to calming blue)"
            },
            {
              "element": "Subheadline",
              "text": "A compassionate journey toward digital wellness and personal growth. Start your recovery with evidence-based tools and supportive community.",
              "style": "Medium size, muted text color"
            },
            {
              "element": "Hero Image",
              "description": "Peaceful illustration showing meditation, growth, and digital wellness",
              "placeholder": "Use a serene illustration with natural elements"
            },
            {
              "element": "Primary CTA Button",
              "text": "Start Your Journey",
              "action": "Navigate to Onboarding Quiz",
              "style": "Large button with gradient background (primary colors), elevated shadow"
            },
            {
              "element": "Secondary Button",
              "text": "Learn More",
              "action": "Scroll to features section",
              "style": "Outlined button"
            }
          ]
        },
        {
          "type": "Feature Cards Section",
          "description": "Three cards highlighting key benefits",
          "cards": [
            {
              "icon": "Heart",
              "title": "Compassionate Support",
              "description": "Non-judgmental tools and community designed to support your recovery journey with empathy and understanding.",
              "color": "compassion"
            },
            {
              "icon": "Shield",
              "title": "Evidence-Based Tools",
              "description": "Research-backed techniques including urge management, mindfulness, and personalized recovery plans.",
              "color": "success"
            },
            {
              "icon": "Users",
              "title": "Community & Accountability",
              "description": "Connect with others on similar journeys through buddy systems and supportive group check-ins.",
              "color": "primary"
            }
          ]
        },
        {
          "type": "Statistics Section",
          "description": "Social proof with key metrics",
          "stats": [
            {
              "number": "10,000+",
              "label": "Lives Reclaimed",
              "color": "primary"
            },
            {
              "number": "85%",
              "label": "Report Improvement",
              "color": "success"
            },
            {
              "number": "30 Days",
              "label": "Average to See Results",
              "color": "secondary-blue"
            }
          ]
        }
      ]
    },

    "2_onboarding_quiz": {
      "name": "Onboarding Quiz",
      "route": "/onboarding",
      "description": "4-question quiz to personalize user experience and understand their goals",
      "navigation": {
        "show_progress_bar": true,
        "show_question_counter": true,
        "allow_back_navigation": true
      },
      "questions": [
        {
          "id": 1,
          "question": "What brings you to Reclaim today?",
          "type": "multiple_choice",
          "options": [
            "I want to reduce my digital consumption",
            "I'm struggling with specific content online",
            "I want to build healthier habits",
            "Someone recommended this to me"
          ],
          "required": true
        },
        {
          "id": 2,
          "question": "How would you rate your current relationship with digital media?",
          "type": "scale",
          "scale": {
            "min": 1,
            "max": 10,
            "min_label": "Very Unhealthy",
            "max_label": "Very Healthy"
          },
          "required": true
        },
        {
          "id": 3,
          "question": "What are your main triggers or challenging moments?",
          "type": "multiple_choice",
          "multiple_selection": true,
          "options": [
            "Stress and anxiety",
            "Boredom or loneliness",
            "Late at night",
            "During work breaks",
            "Social situations"
          ],
          "required": true
        },
        {
          "id": 4,
          "question": "What does success look like for you? (Optional)",
          "type": "text_input",
          "placeholder": "Describe your goals and what you hope to achieve...",
          "multiline": true,
          "required": false
        }
      ],
      "completion_action": {
        "save_to": "MongoDB collection: user_onboarding",
        "set_flag": "onboarding_completed: true",
        "navigate_to": "Dashboard",
        "show_toast": "Welcome to your recovery journey!"
      }
    },

    "3_dashboard": {
      "name": "Dashboard",
      "route": "/dashboard",
      "description": "Main hub showing user progress, statistics, and quick actions",
      "sections": [
        {
          "type": "Welcome Header",
          "elements": [
            {
              "element": "Greeting",
              "text": "Welcome back, [User Name]!",
              "fallback": "Welcome back!"
            },
            {
              "element": "Subtitle",
              "text": "You're doing great. Here's your progress today."
            }
          ]
        },
        {
          "type": "Life Tree Visualization Card",
          "description": "Primary visual representation of user's recovery journey",
          "elements": [
            {
              "element": "Title",
              "text": "Your Life Tree"
            },
            {
              "element": "Status Badge",
              "logic": [
                "If tree_growth >= 75: 'Flourishing'",
                "If tree_growth >= 50: 'Growing Strong'",
                "If tree_growth >= 25: 'Taking Root'",
                "Else: 'Planted'"
              ]
            },
            {
              "element": "Tree Icon",
              "size": "Large (128x128)",
              "animation": "Subtle floating animation",
              "color": "Changes based on growth percentage",
              "color_logic": [
                "growth > 50: success green",
                "growth > 25: primary green",
                "else: muted gray"
              ]
            },
            {
              "element": "Growth Percentage Badge",
              "position": "Bottom right of tree icon",
              "style": "Circular badge with pulse animation"
            },
            {
              "element": "Progress Bar",
              "value": "tree_growth_percentage",
              "height": 12
            },
            {
              "element": "Description",
              "text": "Your tree grows stronger with each positive choice you make"
            }
          ],
          "data_source": "MongoDB: profiles.tree_growth_percentage"
        },
        {
          "type": "Quick Actions Card",
          "description": "Urgent help and daily tools",
          "buttons": [
            {
              "text": "Need Help Now",
              "icon": "Zap",
              "style": "Panic button (red/warning color, bold)",
              "action": "Navigate to Urge Toolkit"
            },
            {
              "text": "Quick Journal",
              "icon": "BookOpen",
              "style": "Outlined button",
              "action": "Open Quick Journal modal/screen"
            },
            {
              "text": "Breathing Exercise",
              "icon": "Heart",
              "style": "Outlined button",
              "action": "Open Breathing Exercise modal/screen"
            },
            {
              "text": "Connect with Buddy",
              "icon": "Users",
              "style": "Outlined button",
              "action": "Open Message Buddy screen"
            },
            {
              "text": "Need Support",
              "icon": "Heart",
              "style": "Outlined button with compassion color border",
              "action": "Navigate to Relapse Recovery"
            }
          ]
        },
        {
          "type": "Statistics Row",
          "description": "Three key metrics displayed as cards",
          "cards": [
            {
              "icon": "Flame",
              "icon_animation": "Soft pulse",
              "icon_color": "Orange (#FF6B35)",
              "title": "[Streak Number]",
              "subtitle": "Day Streak",
              "buttons": [
                {
                  "text": "Mark Clean Day",
                  "action": "Call markCleanDay(true) API"
                },
                {
                  "text": "Record Relapse",
                  "style": "Destructive",
                  "action": "Call markCleanDay(false) API"
                }
              ],
              "data_source": "MongoDB: profiles.total_streak_days"
            },
            {
              "icon": "Target",
              "icon_color": "Primary",
              "title": "[Completed]/[Total]",
              "subtitle": "Daily Tasks",
              "progress_bar": true,
              "data_source": "MongoDB: daily_tasks collection"
            },
            {
              "icon": "Trophy",
              "icon_color": "Secondary Blue",
              "title": "[Achievement Count]",
              "subtitle": "Achievements Earned",
              "data_source": "MongoDB: user_achievements collection count"
            }
          ]
        },
        {
          "type": "Today's Tasks Card",
          "description": "List of daily tasks with completion tracking",
          "elements": [
            {
              "element": "Title",
              "text": "Today's Tasks"
            },
            {
              "element": "Task List",
              "item_structure": {
                "checkbox": "Circle icon (empty) or CheckCircle (completed)",
                "title": "Task title",
                "description": "Optional task description",
                "badge": "Done (green) or Pending (gray)",
                "style": "Completed tasks have line-through and muted color"
              },
              "empty_state": {
                "icon": "Target",
                "text": "No tasks for today. Great work staying on track!"
              }
            }
          ],
          "data_source": "MongoDB: daily_tasks collection (filtered by today's date)",
          "interaction": "Tap checkbox to complete task, updates immediately"
        },
        {
          "type": "Achievements Card",
          "description": "Recent unlocked achievements",
          "elements": [
            {
              "element": "Title",
              "text": "Recent Achievements"
            },
            {
              "element": "Achievement Grid",
              "layout": "2 columns on mobile, 4 columns on tablet",
              "max_displayed": 4,
              "item_structure": {
                "icon": "Achievement emoji/icon (large, 48px)",
                "name": "Achievement name",
                "date_badge": "Date unlocked"
              },
              "empty_state": {
                "icon": "Trophy",
                "primary_text": "Complete milestones to unlock achievements!",
                "secondary_text": "Keep building your streak and completing tasks."
              }
            }
          ],
          "data_source": "MongoDB: user_achievements collection (joined with achievements, sorted by unlocked_at DESC, limit 4)"
        }
      ]
    },

    "4_urge_toolkit": {
      "name": "Urge Toolkit",
      "route": "/urge-toolkit",
      "description": "Emergency toolkit for managing strong urges and cravings",
      "header": {
        "back_button": true,
        "back_action": "Navigate to Dashboard",
        "icon": "Zap",
        "title": "You're Taking Control",
        "subtitle": "This moment of pause shows your strength. Choose a tool to help you through this."
      },
      "flow": [
        {
          "step": 1,
          "type": "Urgency Assessment",
          "question": "How intense is this feeling right now?",
          "options": [
            {
              "level": 1,
              "emoji": "😌",
              "label": "Mild",
              "button_style": "Outlined"
            },
            {
              "level": 2,
              "emoji": "😰",
              "label": "Moderate",
              "button_style": "Outlined"
            },
            {
              "level": 3,
              "emoji": "🚨",
              "label": "Intense",
              "button_style": "Panic (red/warning)"
            }
          ]
        },
        {
          "step": 2,
          "type": "Tool Selection",
          "description": "After selecting urgency level, show tool options in two categories",
          "categories": [
            {
              "title": "Immediate Relief",
              "icon": "Clock",
              "tools": [
                {
                  "name": "Breathing Exercise",
                  "icon": "Heart",
                  "duration": "2 min",
                  "style": "Primary button",
                  "action": "Open Breathing Exercise"
                },
                {
                  "name": "10 Minute Timer",
                  "icon": "Clock",
                  "duration": "10 min",
                  "style": "Outlined button",
                  "action": "Open Timer"
                },
                {
                  "name": "Distraction Game",
                  "icon": "Zap",
                  "duration": "Variable",
                  "style": "Outlined button",
                  "action": "Open Memory Game"
                }
              ]
            },
            {
              "title": "Reflection & Support",
              "icon": "BookOpen",
              "tools": [
                {
                  "name": "Quick Journal",
                  "icon": "BookOpen",
                  "style": "Outlined button",
                  "action": "Open Journal"
                },
                {
                  "name": "Message Buddy",
                  "icon": "Users",
                  "style": "Outlined button",
                  "action": "Open Message Buddy"
                },
                {
                  "name": "Crisis Support",
                  "icon": "Phone",
                  "style": "Outlined button",
                  "action": "Open Crisis Support"
                }
              ]
            }
          ]
        }
      ],
      "tools": {
        "breathing_exercise": {
          "name": "Breathing Exercise",
          "description": "Guided 4-4-6 breathing pattern (inhale 4s, hold 4s, exhale 6s)",
          "total_cycles": 8,
          "cycle_structure": {
            "phases": [
              {
                "name": "inhale",
                "duration": 4,
                "instruction": "Breathe in slowly through your nose",
                "visual": "Circle expands/scales up"
              },
              {
                "name": "hold",
                "duration": 4,
                "instruction": "Hold your breath gently",
                "visual": "Circle stays large"
              },
              {
                "name": "exhale",
                "duration": 6,
                "instruction": "Breathe out slowly through your mouth",
                "visual": "Circle contracts/scales down"
              }
            ]
          },
          "ui": {
            "title": "Breathing Exercise",
            "subtitle": "Follow the circle and breathe with the rhythm",
            "progress_bar": true,
            "cycle_counter": "Cycle X of 8",
            "visual_element": {
              "type": "Animated Circle",
              "size": 128,
              "color": "Gradient calm (blue to green)",
              "border": "4px primary color",
              "animation": "Scale transform based on phase"
            },
            "countdown": {
              "size": "Large (48px)",
              "display": "Seconds remaining in current phase"
            },
            "phase_label": {
              "size": "Medium",
              "display": "Current phase (inhale/hold/exhale)"
            },
            "instruction_text": {
              "size": "Small",
              "display": "Phase-specific instruction"
            }
          },
          "completion_action": "Show completion message for 1 second, then return to toolkit"
        },
        "timer": {
          "name": "10 Minute Timer",
          "description": "Simple countdown timer to create space between urge and action",
          "duration": 600,
          "ui": {
            "title": "10 Minute Timer",
            "subtitle": "Take these 10 minutes to pause, breathe, and let the feeling pass",
            "progress_bar": true,
            "visual_element": {
              "type": "Large Circle Display",
              "size": 192,
              "background": "Gradient calm",
              "border": "4px primary border"
            },
            "time_display": {
              "format": "MM:SS",
              "size": "Very large (64px)",
              "color": "Primary"
            },
            "status_text": {
              "running": "Running...",
              "paused": "Paused",
              "complete": "Complete!"
            },
            "controls": [
              {
                "button": "Start/Pause Toggle",
                "icon": "Play or Pause",
                "style": "Primary button",
                "disabled_when": "time === 0"
              },
              {
                "button": "Reset",
                "icon": "RotateCcw",
                "style": "Outlined button"
              }
            ],
            "info_card": {
              "text": "Use this time to practice breathing, mindfulness, or any coping strategy that works for you. Remember: urges are temporary and will pass.",
              "style": "Muted background card"
            }
          }
        },
        "distraction_game": {
          "name": "Memory Game",
          "description": "Simon-style memory game to redirect attention",
          "mechanics": {
            "colors": 8,
            "color_palette": [
              "#EF4444",
              "#3B82F6",
              "#10B981",
              "#F59E0B",
              "#8B5CF6",
              "#EC4899",
              "#6366F1",
              "#F97316"
            ],
            "starting_sequence_length": 1,
            "max_levels": 5,
            "sequence_increment": "Add 1 color per level",
            "scoring": "sequence_length * 10 points per level"
          },
          "game_phases": [
            "waiting",
            "showing",
            "playing",
            "complete"
          ],
          "ui": {
            "title": "Memory Game",
            "subtitle": "Follow the color sequence to keep your mind occupied and focused",
            "badges": [
              "Level [X]",
              "Score [X]"
            ],
            "waiting_phase": {
              "button": "Start Game",
              "icon": "Shuffle",
              "instructions": "Watch the sequence of colors, then repeat it by clicking the colors in the same order. Complete 5 levels to finish the game!"
            },
            "showing_phase": {
              "status_card": {
                "text": "Watch the sequence...",
                "color": "Primary background"
              }
            },
            "playing_phase": {
              "status_card": {
                "text": "Now repeat the sequence!",
                "progress": "Progress: [X]/[Total]",
                "color": "Success background"
              }
            },
            "complete_phase": {
              "success_message": {
                "title": "Congratulations!",
                "message": "You completed all 5 levels! Final score: [score]"
              },
              "partial_message": {
                "title": "Good Try!",
                "message": "You reached level [level] with a score of [score]"
              },
              "buttons": [
                {
                  "text": "Play Again",
                  "style": "Outlined"
                },
                {
                  "text": "Done Playing",
                  "style": "Primary"
                }
              ]
            },
            "color_grid": {
              "layout": "4x2 grid",
              "button_size": 64,
              "button_style": {
                "default": "75% brightness",
                "active": "110% brightness + scale + shadow",
                "hover": "90% brightness"
              }
            }
          }
        },
        "quick_journal": {
          "name": "Quick Journal",
          "description": "Rapid journaling to process emotions",
          "ui": {
            "title": "Quick Journal",
            "subtitle": "Take a moment to reflect on your feelings",
            "prompts": [
              "What am I feeling right now?",
              "What triggered this urge?",
              "What would help me feel better?",
              "What am I grateful for today?",
              "What's one thing I can do for myself right now?"
            ],
            "prompt_section": {
              "title": "Reflection prompts:",
              "style": "Muted background card",
              "interaction": "Tap prompt to add it to journal text area"
            },
            "text_input": {
              "placeholder": "Write about what you're experiencing... your thoughts, feelings, or anything that comes to mind.",
              "multiline": true,
              "min_height": 160
            },
            "buttons": [
              {
                "text": "Save for Later",
                "style": "Outlined",
                "action": "Save to MongoDB and close"
              },
              {
                "text": "Done Reflecting",
                "style": "Primary",
                "action": "Save and close"
              }
            ]
          },
          "data_storage": "MongoDB: journal_entries collection"
        },
        "message_buddy": {
          "name": "Message Buddy",
          "description": "Pre-written messages to reach out for support",
          "ui": {
            "title": "Connect with Your Support Network",
            "subtitle": "Reach out to someone you trust. Choose a template or write your own message.",
            "templates": [
              {
                "id": "support",
                "title": "Need Support",
                "message": "Hi! I'm having a tough moment right now and could use some encouragement. Are you available to chat?"
              },
              {
                "id": "checkin",
                "title": "Check-in",
                "message": "Hey! Just wanted to check in and let you know I'm thinking about you. How are you doing today?"
              },
              {
                "id": "craving",
                "title": "Managing Cravings",
                "message": "I'm dealing with some strong urges right now. Can we talk? It would really help to have someone to talk through this with."
              },
              {
                "id": "victory",
                "title": "Share Victory",
                "message": "I wanted to share some good news with you! I've been making great progress and wanted to celebrate with someone who understands."
              },
              {
                "id": "gratitude",
                "title": "Express Gratitude",
                "message": "I just wanted to say thank you for being such an important part of my recovery journey. Your support means everything to me."
              }
            ],
            "template_cards": {
              "layout": "2 column grid on mobile",
              "selection": "Single selection, tap to select",
              "selected_style": "Primary background + primary border",
              "unselected_style": "Muted background + border"
            },
            "custom_message": {
              "title": "Custom Message",
              "placeholder": "Write your own message...",
              "multiline": true,
              "min_height": 96,
              "behavior": "Typing deselects templates"
            },
            "preview_section": {
              "condition": "Show only when template selected or custom message entered",
              "title": "Preview Message",
              "message_display": {
                "style": "Background card with border"
              },
              "buttons": [
                {
                  "text": "Copy Message",
                  "icon": "Copy",
                  "style": "Primary",
                  "action": "Copy to clipboard and show toast",
                  "success_text": "Copied!",
                  "success_icon": "Check"
                },
                {
                  "text": "Done",
                  "style": "Outlined",
                  "action": "Close screen"
                }
              ]
            },
            "info_footer": {
              "text": "After copying your message, you can paste it into your preferred messaging app (SMS, WhatsApp, email, etc.) to send to your support person.",
              "style": "Small text, muted background"
            }
          }
        },
        "crisis_support": {
          "name": "Crisis Support",
          "description": "Emergency mental health resources and hotlines",
          "ui": {
            "header": {
              "icon": "Heart",
              "icon_animation": "Soft pulse",
              "icon_color": "Compassion",
              "title": "You're Not Alone",
              "subtitle": "If you're having thoughts of self-harm or suicide, please reach out for help immediately. These resources are available 24/7."
            },
            "emergency_contacts_section": {
              "title": "Emergency Support",
              "style": "Destructive background (red tint)",
              "contacts": [
                {
                  "name": "Crisis Text Line",
                  "description": "Text HOME to 741741",
                  "action": "Text 741741",
                  "icon": "MessageCircle",
                  "button_style": "Destructive",
                  "button_action": "Open SMS app with pre-filled number"
                },
                {
                  "name": "National Suicide Prevention Lifeline",
                  "description": "24/7 free and confidential support",
                  "action": "Call 988",
                  "icon": "Phone",
                  "button_style": "Destructive",
                  "button_action": "Open phone dialer with number"
                }
              ]
            },
            "additional_support_section": {
              "title": "Additional Support",
              "contacts": [
                {
                  "name": "SAMHSA National Helpline",
                  "description": "Substance abuse and mental health services",
                  "action": "Call 1-800-662-4357",
                  "icon": "Phone",
                  "button_style": "Outlined",
                  "button_action": "Open phone dialer with number"
                }
              ]
            },
            "online_resources_section": {
              "title": "Online Resources",
              "resources": [
                {
                  "name": "Crisis Text Line",
                  "description": "Free, 24/7 support via text message",
                  "url": "https://www.crisistextline.org/",
                  "button_text": "Visit",
                  "button_icon": "ExternalLink"
                },
                {
                  "name": "SAMHSA Treatment Locator",
                  "description": "Find treatment facilities and programs",
                  "url": "https://findtreatment.samhsa.gov/",
                  "button_text": "Visit",
                  "button_icon": "ExternalLink"
                },
                {
                  "name": "National Alliance on Mental Illness",
                  "description": "Support groups and resources",
                  "url": "https://nami.org/",
                  "button_text": "Visit",
                  "button_icon": "ExternalLink"
                }
              ]
            },
            "closing_card": {
              "title": "Remember",
              "message": "Reaching out for help is a sign of strength, not weakness. You deserve support and care.",
              "button": {
                "text": "I'm Safe for Now",
                "style": "Primary",
                "action": "Close crisis support and return"
              }
            }
          }
        }
      },
      "encouragement_footer": {
        "title": "Remember: This feeling will pass",
        "message": "You've made it through difficult moments before. Every moment you pause and choose a healthy response is a victory.",
        "style": "Gradient calm background card"
      }
    },

    "5_relapse_recovery": {
      "name": "Relapse Recovery",
      "route": "/relapse-recovery",
      "description": "Compassionate support flow for processing and learning from relapses",
      "header": {
        "back_button": true,
        "icon": "Heart",
        "icon_color": "Compassion",
        "title": "You're Being Brave",
        "subtitle": "Taking the time to reflect on this moment shows incredible self-awareness and courage. Let's turn this into learning and growth together."
      },
      "flow": [
        {
          "step": 1,
          "type": "Context Gathering",
          "title": "Help us understand what happened",
          "sections": [
            {
              "title": "What might have triggered this moment?",
              "subtitle": "(Select all that apply)",
              "type": "Multiple selection buttons",
              "options": [
                "Stress/Anxiety",
                "Boredom",
                "Loneliness",
                "Late Night",
                "Work Pressure",
                "Social Media",
                "Relationship Issues",
                "Other"
              ],
              "style": "Button grid, selected buttons have primary background"
            },
            {
              "title": "What was happening around this time?",
              "subtitle": "(Optional)",
              "icon": "Clock",
              "type": "Text area",
              "placeholder": "Describe your environment, mood, or what was happening...",
              "multiline": true,
              "min_height": 96
            }
          ],
          "buttons": [
            {
              "text": "Skip This Step",
              "style": "Outlined"
            },
            {
              "text": "Continue to Recovery",
              "style": "Primary (gradient)",
              "disabled": "No triggers selected"
            }
          ],
          "info_footer": {
            "text": "This information helps create a personalized plan to support you better. Everything you share is private and secure.",
            "style": "Gradient calm background"
          },
          "data_storage": "MongoDB: relapse_logs collection"
        },
        {
          "step": 2,
          "type": "Recovery Reset Plan",
          "header": {
            "icon": "Target",
            "title": "Your Recovery Reset Plan",
            "subtitle": "These steps are designed to help you move forward with compassion and strength."
          },
          "steps": [
            {
              "number": 1,
              "title": "Acknowledge without judgment",
              "description": "This is part of the journey, not a failure",
              "action_buttons": [
                {
                  "text": "Complete This Step",
                  "style": "Primary"
                }
              ]
            },
            {
              "number": 2,
              "title": "Learn from this moment",
              "description": "What can this teach you about your patterns?",
              "action_buttons": [
                {
                  "text": "Complete This Step",
                  "style": "Primary"
                },
                {
                  "text": "Quick Journal",
                  "icon": "BookOpen",
                  "style": "Outlined",
                  "action": "Open journal modal"
                }
              ]
            },
            {
              "number": 3,
              "title": "Reconnect with your why",
              "description": "Remember why you started this journey",
              "action_buttons": [
                {
                  "text": "Complete This Step",
                  "style": "Primary"
                }
              ]
            },
            {
              "number": 4,
              "title": "Plan your next 24 hours",
              "description": "Set yourself up for success today",
              "action_buttons": [
                {
                  "text": "Complete This Step",
                  "style": "Primary"
                }
              ]
            },
            {
              "number": 5,
              "title": "Reach out for support",
              "description": "You don't have to do this alone",
              "action_buttons": [
                {
                  "text": "Complete This Step",
                  "style": "Primary"
                },
                {
                  "text": "Contact Buddy",
                  "icon": "Users",
                  "style": "Outlined",
                  "action": "Open message buddy"
                }
              ]
            }
          ],
          "step_card_styles": {
            "incomplete": {
              "background": "Card background",
              "border": "Border color",
              "shadow": "Soft shadow"
            },
            "completed": {
              "background": "Success background (light green)",
              "border": "Success border",
              "shadow": "Soft shadow",
              "badge": "✓ Completed (success badge)"
            }
          },
          "progress_footer": {
            "style": "Gradient healing background (green to blue gradient)",
            "title": "Progress: [X]/5 Steps Complete",
            "message": "Each step you complete is a victory. You're already on your way back.",
            "buttons": [
              {
                "text": "Save Progress",
                "style": "White outlined on gradient"
              },
              {
                "text": "Return to Dashboard",
                "style": "White outlined on gradient"
              }
            ]
          }
        }
      ]
    }
  },

  "data_models": {
    "database": "MongoDB",
    "collections": [
      {
        "name": "users",
        "description": "Core user accounts (created during onboarding)",
        "schema": {
          "_id": "ObjectId",
          "email": "String (optional, for future auth)",
          "display_name": "String",
          "created_at": "Date",
          "updated_at": "Date"
        },
        "indexes": ["_id", "email"]
      },
      {
        "name": "profiles",
        "description": "User profile and progress data",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "display_name": "String",
          "streak_start_date": "Date",
          "total_streak_days": "Number (default: 0)",
          "longest_streak": "Number (default: 0)",
          "tree_growth_percentage": "Number (default: 0, max: 100)",
          "created_at": "Date",
          "updated_at": "Date"
        },
        "indexes": ["user_id"],
        "unique": ["user_id"]
      },
      {
        "name": "user_onboarding",
        "description": "Onboarding quiz responses",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "question_1_answer": "String",
          "question_2_answer": "Number (1-10)",
          "question_3_answers": "Array of Strings",
          "question_4_answer": "String (optional)",
          "completed_at": "Date"
        },
        "indexes": ["user_id"]
      },
      {
        "name": "daily_progress",
        "description": "Daily check-ins and progress tracking",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "date": "Date (YYYY-MM-DD)",
          "is_clean_day": "Boolean (default: true)",
          "mood_rating": "Number (1-5, optional)",
          "notes": "String (optional)",
          "completed_tasks": "Number",
          "total_tasks": "Number",
          "created_at": "Date",
          "updated_at": "Date"
        },
        "indexes": ["user_id", "date"],
        "unique": ["user_id + date"]
      },
      {
        "name": "daily_tasks",
        "description": "Daily tasks/goals for users",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "title": "String",
          "description": "String (optional)",
          "is_completed": "Boolean (default: false)",
          "task_date": "Date (YYYY-MM-DD)",
          "completed_at": "Date (optional)",
          "created_at": "Date",
          "updated_at": "Date"
        },
        "indexes": ["user_id", "task_date"]
      },
      {
        "name": "achievements",
        "description": "Master list of all possible achievements",
        "schema": {
          "_id": "ObjectId",
          "name": "String",
          "description": "String",
          "icon": "String (emoji)",
          "unlock_criteria": "Object { type: String, value: Number }",
          "created_at": "Date"
        },
        "seed_data": [
          {"name": "First Day", "description": "Completed your first day of recovery", "icon": "🌱", "unlock_criteria": {"type": "streak", "days": 1}},
          {"name": "One Week Strong", "description": "Maintained sobriety for 7 consecutive days", "icon": "🗓️", "unlock_criteria": {"type": "streak", "days": 7}},
          {"name": "Two Weeks Milestone", "description": "Reached 14 days of continuous recovery", "icon": "💪", "unlock_criteria": {"type": "streak", "days": 14}},
          {"name": "One Month Hero", "description": "Achieved 30 days of sobriety", "icon": "🏆", "unlock_criteria": {"type": "streak", "days": 30}},
          {"name": "Three Month Champion", "description": "Completed 90 days of recovery", "icon": "👑", "unlock_criteria": {"type": "streak", "days": 90}},
          {"name": "Half Year Warrior", "description": "Reached 180 days of sobriety", "icon": "⚡", "unlock_criteria": {"type": "streak", "days": 180}},
          {"name": "One Year Legend", "description": "Celebrated 365 days of recovery", "icon": "🎉", "unlock_criteria": {"type": "streak", "days": 365}},
          {"name": "Task Master", "description": "Completed 50 daily tasks", "icon": "✅", "unlock_criteria": {"type": "tasks", "count": 50}},
          {"name": "Mood Tracker", "description": "Logged mood for 7 consecutive days", "icon": "😊", "unlock_criteria": {"type": "mood_tracking", "days": 7}},
          {"name": "Tree Nurturer", "description": "Reached 50% tree growth", "icon": "🌳", "unlock_criteria": {"type": "tree_growth", "percentage": 50}}
        ]
      },
      {
        "name": "user_achievements",
        "description": "Achievements unlocked by users",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "achievement_id": "ObjectId (reference to achievements)",
          "unlocked_at": "Date"
        },
        "indexes": ["user_id", "achievement_id"],
        "unique": ["user_id + achievement_id"]
      },
      {
        "name": "journal_entries",
        "description": "User journal entries",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "entry_text": "String",
          "entry_type": "String (quick_journal, urge_reflection, relapse_recovery)",
          "created_at": "Date"
        },
        "indexes": ["user_id", "created_at"]
      },
      {
        "name": "relapse_logs",
        "description": "Relapse tracking and learning",
        "schema": {
          "_id": "ObjectId",
          "user_id": "ObjectId (reference to users)",
          "triggers": "Array of Strings",
          "context_notes": "String (optional)",
          "recovery_steps_completed": "Array of Numbers (1-5)",
          "logged_at": "Date"
        },
        "indexes": ["user_id", "logged_at"]
      }
    ]
  },

  "backend_api_routes": {
    "description": "REST API endpoints for MongoDB operations",
    "base_url": "/api",
    "authentication": "For now, use guest mode with device ID. Future: JWT tokens",
    "endpoints": [
      {
        "path": "/users",
        "method": "POST",
        "description": "Create new user (during onboarding)",
        "request_body": {
          "display_name": "String"
        },
        "response": {
          "user_id": "ObjectId",
          "message": "User created successfully"
        }
      },
      {
        "path": "/profiles/:userId",
        "method": "GET",
        "description": "Get user profile and stats",
        "response": {
          "profile": "Profile object",
          "streak": "Number",
          "tree_growth": "Number"
        }
      },
      {
        "path": "/profiles/:userId",
        "method": "PUT",
        "description": "Update user profile",
        "request_body": {
          "display_name": "String (optional)",
          "tree_growth_percentage": "Number (optional)"
        }
      },
      {
        "path": "/daily-progress/:userId",
        "method": "POST",
        "description": "Record daily progress",
        "request_body": {
          "is_clean_day": "Boolean",
          "mood_rating": "Number (optional)",
          "notes": "String (optional)"
        }
      },
      {
        "path": "/daily-progress/:userId/:date",
        "method": "GET",
        "description": "Get progress for specific date"
      },
      {
        "path": "/daily-tasks/:userId",
        "method": "GET",
        "description": "Get tasks for today",
        "query_params": {
          "date": "Date (optional, defaults to today)"
        }
      },
      {
        "path": "/daily-tasks",
        "method": "POST",
        "description": "Create new daily task",
        "request_body": {
          "user_id": "ObjectId",
          "title": "String",
          "description": "String (optional)",
          "task_date": "Date"
        }
      },
      {
        "path": "/daily-tasks/:taskId",
        "method": "PUT",
        "description": "Update task (mark complete)",
        "request_body": {
          "is_completed": "Boolean",
          "completed_at": "Date (optional)"
        }
      },
      {
        "path": "/achievements",
        "method": "GET",
        "description": "Get all available achievements"
      },
      {
        "path": "/user-achievements/:userId",
        "method": "GET",
        "description": "Get user's unlocked achievements"
      },
      {
        "path": "/user-achievements",
        "method": "POST",
        "description": "Unlock achievement for user",
        "request_body": {
          "user_id": "ObjectId",
          "achievement_id": "ObjectId"
        }
      },
      {
        "path": "/journal-entries",
        "method": "POST",
        "description": "Create journal entry",
        "request_body": {
          "user_id": "ObjectId",
          "entry_text": "String",
          "entry_type": "String"
        }
      },
      {
        "path": "/relapse-logs",
        "method": "POST",
        "description": "Log relapse details",
        "request_body": {
          "user_id": "ObjectId",
          "triggers": "Array of Strings",
          "context_notes": "String (optional)"
        }
      },
      {
        "path": "/relapse-logs/:logId",
        "method": "PUT",
        "description": "Update relapse log with completed recovery steps",
        "request_body": {
          "recovery_steps_completed": "Array of Numbers"
        }
      }
    ]
  },

  "local_storage_keys": {
    "description": "Data stored locally on device using AsyncStorage",
    "keys": [
      {
        "key": "onboarding_completed",
        "type": "Boolean",
        "description": "Whether user has completed onboarding"
      },
      {
        "key": "user_id",
        "type": "String (ObjectId)",
        "description": "Current user's ID"
      },
      {
        "key": "device_id",
        "type": "String",
        "description": "Unique device identifier for guest mode"
      },
      {
        "key": "onboarding_answers",
        "type": "JSON String",
        "description": "Cached onboarding quiz responses"
      }
    ]
  },

  "streak_calculation_logic": {
    "description": "How to calculate and maintain user streaks",
    "method": "Server-side calculation on each daily check-in",
    "algorithm": [
      "Query daily_progress collection for user_id",
      "Filter for is_clean_day = true",
      "Sort by date DESC",
      "Count consecutive days from most recent clean day to today",
      "If gap exists (date - previous_date > 1 day), streak breaks",
      "Update profiles.total_streak_days",
      "If current streak > longest_streak, update profiles.longest_streak",
      "Calculate tree_growth_percentage = min(100, total_streak_days * 2)"
    ],
    "tree_growth_formula": "tree_growth_percentage = Math.min(100, total_streak_days * 2)",
    "tree_growth_note": "2% growth per clean day, caps at 100%"
  },

  "achievement_unlock_logic": {
    "description": "Automatically check and unlock achievements",
    "triggers": [
      "After marking clean day (check streak achievements)",
      "After completing task (check task count achievements)",
      "After logging mood (check mood tracking achievements)",
      "After tree growth update (check tree growth achievements)"
    ],
    "process": [
      "Query achievements collection for unlock_criteria",
      "Check if user meets criteria",
      "Query user_achievements to ensure not already unlocked",
      "If criteria met and not unlocked, insert into user_achievements",
      "Show toast notification: 'Achievement Unlocked: [name]'"
    ]
  },

  "animations_and_transitions": {
    "page_transitions": "Slide from right (forward), slide to right (back)",
    "button_press": "Scale down to 0.95, spring back",
    "card_hover": "Subtle scale to 1.02, increase shadow",
    "list_item_appearance": "Fade in + slide up stagger",
    "success_feedback": "Green checkmark with scale + fade animation",
    "loading_states": "Skeleton screens or spinner with fade-in"
  },

  "accessibility_requirements": {
    "font_sizes": "Respect system font size settings",
    "color_contrast": "Minimum WCAG AA contrast ratios (4.5:1 for normal text)",
    "touch_targets": "Minimum 44x44 points for all interactive elements",
    "screen_reader": "Add accessibilityLabel to all interactive elements",
    "focus_indicators": "Visible focus states for keyboard navigation"
  },

  "notifications": {
    "types": [
      {
        "type": "Daily Reminder",
        "time": "User-configured (default: 9 AM)",
        "title": "Check In Today",
        "body": "Take a moment to log your progress and check your tree's growth"
      },
      {
        "type": "Streak Milestone",
        "trigger": "Achievement unlocked",
        "title": "Achievement Unlocked!",
        "body": "[Achievement Name] - [Achievement Description]"
      },
      {
        "type": "Encouragement",
        "trigger": "After marking relapse",
        "title": "You're Stronger Than You Know",
        "body": "Every moment is a chance to begin again. We're here for you."
      }
    ],
    "implementation": "Use Expo Notifications API"
  },

  "error_handling": {
    "network_errors": "Show toast: 'Connection error. Please try again.'",
    "validation_errors": "Show inline error messages below form fields",
    "server_errors": "Show toast: 'Something went wrong. Please try again later.'",
    "offline_mode": "Allow read-only access to cached data, queue writes"
  },

  "testing_strategy": {
    "manual_testing": "Test on physical Android device via Expo Go",
    "test_cases": [
      "Complete onboarding flow and verify data saved",
      "Mark clean day and verify streak increases",
      "Complete all daily tasks and verify progress",
      "Trigger each urge toolkit tool",
      "Complete relapse recovery flow",
      "Unlock achievements at various milestones",
      "Test with no internet connection"
    ]
  },

  "future_enhancements": {
    "authentication": "Add proper email/password authentication",
    "social_features": "Buddy matching system",
    "community": "Support groups and forums",
    "ai_coaching": "Personalized suggestions based on patterns",
    "export_data": "Allow users to download their progress",
    "dark_mode": "Full dark theme support",
    "multi_language": "Internationalization"
  },

  "deployment_notes": {
    "development": "Use Expo Go for immediate testing on Android",
    "production": "Build standalone APK with EAS Build",
    "mongodb_hosting": "MongoDB Atlas (free tier available)",
    "api_hosting": "Consider Heroku, Railway, or Vercel for backend API"
  },

  "important_notes": [
    "This app deals with sensitive mental health topics - always use compassionate, non-judgmental language",
    "Crisis support resources must be accurate and up-to-date",
    "Data privacy is critical - ensure all user data is secure",
    "The app should work offline for core features (use AsyncStorage cache)",
    "Animations should be smooth and purposeful, not distracting",
    "Always provide immediate feedback for user actions",
    "Tree growth visualization is the primary motivational mechanic",
    "Streaks should be encouraging, not punishing",
    "The app tone should be: supportive, hopeful, calm, and empowering"
  ]
}
